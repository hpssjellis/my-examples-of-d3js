<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Enhanced AI BPMN Tool</title>
  <script src="https://d3js.org/d3.v7.min.js"></script>
  <style>
    body {
      font-family: 'Inter', Arial, sans-serif;
      background: linear-gradient(135deg, #f9fafb, #eef2f7);
      color: #334155;
      padding: 2rem;
      display: flex;
      flex-direction: column;
      align-items: center;
      min-height: 100vh;
      text-align: center;
    }

    h1 { margin-bottom: 0.25rem; }
    p {
      margin-top: 0;
      margin-bottom: 1.5rem;
      font-size: 0.9rem;
      color: #6b7280;
    }

    .my-container {
      background-color: #fff;
      padding: 2rem;
      border-radius: 1rem;
      box-shadow: 0 8px 20px rgba(0, 0, 0, 0.08);
      max-width: 900px;
      width: 95%;
      display: flex;
      flex-direction: column;
      gap: 1rem;
      margin-bottom: 2.5rem;
      transition: transform 0.2s ease-in-out;
    }
    .my-container:hover { transform: translateY(-2px); }

    .my-button {
      padding: 0.75rem 1.25rem;
      font-weight: 600;
      border-radius: 0.5rem;
      border: none;
      cursor: pointer;
      transition: all 0.2s ease-in-out;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.12);
      min-width: 130px;
    }
    .my-button:disabled {
      background-color: #cbd5e1;
      cursor: not-allowed;
      box-shadow: none;
    }
    .my-button:hover:not(:disabled) {
      transform: translateY(-2px);
    }

    .my-load-button { background-color: #4b5563; color: white; }
    .my-stream-button { background-color: #10b981; color: white; }
    .my-save-button { background-color: #2563eb; color: white; }

    .my-button-group {
      display: flex;
      gap: 1rem;
      justify-content: center;
      flex-wrap: wrap;
    }

    .my-textarea {
      width: 100%;
      padding: 1rem;
      border-radius: 0.5rem;
      border: 1px solid #d1d5db;
      resize: vertical;
      min-height: 120px;
      font-family: monospace;
      font-size: 0.9rem;
      box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.05);
    }
    .my-output {
      background-color: #f9fafb;
      border: 1px solid #e5e7eb;
    }

    .my-status {
      min-height: 2rem;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 0.9rem;
      font-weight: 500;
      color: #475569;
    }

    #myD3Controls {
      margin-bottom: 20px;
      display: flex;
      flex-wrap: wrap;
      gap: 12px;
      justify-content: center;
    }
    .myD3Button {
      padding: 10px 18px;
      font-size: 15px;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      transition: transform 0.2s ease, box-shadow 0.2s ease;
      color: white;
    }
    .myD3Button:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 12px rgba(0,0,0,0.15);
    }
    #myLoadD3Button { background-color: #4CAF50; }
    #mySaveD3Button { background-color: #2196F3; }
    #myAddD3Button { background-color: #9C27B0; }
    #myAddLineD3Button { background-color: #FF9800; }
    #myFitScreenD3Button { background-color: #FF5722; }
    #myTidyUpD3Button { background-color: #6c757d; }

    #mySvgContainer {
      border: 2px solid #e5e7eb;
      border-radius: 12px;
      background-color: #fafafa;
      margin-top: 1rem;
    }

    /* D3 Node Styling */
    .my-node circle {
      fill: url(#myNodeGradient);
      stroke: #4b5563;
      stroke-width: 1.5px;
      filter: drop-shadow(0px 3px 4px rgba(0,0,0,0.25));
    }
    .my-node text {
      font-size: 12px;
      font-weight: 600;
      fill: #374151;
      pointer-events: none;
    }
    .my-link {
      stroke: #9ca3af;
      stroke-width: 2px;
      opacity: 0.7;
    }

    .my-footer {
      margin-top: 2rem;
      font-size: 0.8rem;
      color: #9ca3af;
    }
    .my-footer a {
      color: #4b5563;
      font-weight: 600;
      text-decoration: none;
    }
  </style>
</head>
<body>
  <h1>Enhanced AI BPMN Tool</h1>
  <p>Single Page AI Tool with Graph Visualization</p>

  <div class="my-container">
    <div class="my-button-group">
      <input type="button" value="Load" class="my-button my-load-button" onclick="myLoadFile()">
      <input type="button" value="Stream" class="my-button my-stream-button" onclick="myStreamAI()">
      <input type="button" value="Save" class="my-button my-save-button" onclick="mySaveFile()">
    </div>
    <textarea id="myInput" class="my-textarea" placeholder="Enter your text or BPMN instructions here..."></textarea>
    <div id="myStatus" class="my-status">Status: Idle</div>
    <textarea id="myOutput" class="my-textarea my-output" placeholder="AI output will appear here..." readonly></textarea>
  </div>

  <div class="my-container">
    <h2>BPMN Graph Editor</h2>
    <div id="myD3Controls">
      <button id="myLoadD3Button" class="myD3Button">Load Graph</button>
      <button id="mySaveD3Button" class="myD3Button">Save Graph</button>
      <button id="myAddD3Button" class="myD3Button">Add Node</button>
      <button id="myAddLineD3Button" class="myD3Button">Add Line</button>
      <button id="myFitScreenD3Button" class="myD3Button">Fit Screen</button>
      <button id="myTidyUpD3Button" class="myD3Button">Tidy Up</button>
    </div>
    <div id="mySvgContainer">
      <svg id="mySvg" width="800" height="500"></svg>
      <svg style="height:0">
        <defs>
          <linearGradient id="myNodeGradient" x1="0" y1="0" x2="1" y2="1">
            <stop offset="0%" stop-color="#60a5fa"/>
            <stop offset="100%" stop-color="#3b82f6"/>
          </linearGradient>
        </defs>
      </svg>
    </div>
  </div>

  <div class="my-footer">
    Built for learning â€¢ <a href="#">TinyML & BPMN</a>
  </div>

  <script>
    // Example D3.js Graph
    const mySvg = d3.select("#mySvg");
    const myWidth = +mySvg.attr("width");
    const myHeight = +mySvg.attr("height");

    const myNodes = [
      { id: "Start" },
      { id: "Task A" },
      { id: "Task B" },
      { id: "End" }
    ];
    const myLinks = [
      { source: "Start", target: "Task A" },
      { source: "Task A", target: "Task B" },
      { source: "Task B", target: "End" }
    ];

    const mySimulation = d3.forceSimulation(myNodes)
      .force("link", d3.forceLink(myLinks).id(d => d.id).distance(150))
      .force("charge", d3.forceManyBody().strength(-400))
      .force("center", d3.forceCenter(myWidth / 2, myHeight / 2));

    const myLink = mySvg.append("g")
      .selectAll("line")
      .data(myLinks)
      .enter().append("line")
      .attr("class", "my-link");

    const myNode = mySvg.append("g")
      .selectAll("g")
      .data(myNodes)
      .enter().append("g")
      .attr("class", "my-node");

    myNode.append("circle").attr("r", 28);

    myNode.append("text")
      .text(d => d.id)
      .attr("text-anchor", "middle")
      .attr("dy", ".35em");

    mySimulation.on("tick", () => {
      myLink
        .attr("x1", d => d.source.x)
        .attr("y1", d => d.source.y)
        .attr("x2", d => d.target.x)
        .attr("y2", d => d.target.y);

      myNode.attr("transform", d => `translate(${d.x},${d.y})`);
    });
  </script>
</body>
</html>
